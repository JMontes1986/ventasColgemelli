
rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    // Permite que cualquiera lea la lista de productos, pero solo los usuarios
    // autenticados (administradores/cajeros) pueden crear, actualizar o eliminar.
    match /products/{productId} {
      allow read: if true;
      allow write: if request.auth != null;
    }

    // Permite que cualquiera cree un registro de compra, pero nadie puede leer
    // o modificar los registros de otros. La lógica para que un usuario
    // vea su propio historial se manejará en la consulta de la aplicación.
    match /purchases/{purchaseId} {
      allow create: if true;
      allow read, update, delete: if false;
    }
  }
}
